<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Opis doniczki - IoTAzurePi</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <link href='https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Opis doniczki";
    var mkdocs_page_input_path = "opis_doniczki.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> IoTAzurePi</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="tocbase current">
    
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Wprowadzenie</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="..">Opis projektu</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../instalacja_uruchomienie/">Instalacja</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../obsluga_projektu/">Obsługa</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">WebApp</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../webAppGUI/">Interfejs użytkownika</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../cosmoDB/">CosmoDB</a>
  </li>
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Urządzenie IoT</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  
    
    <li class="navtree toctree-l2 page current">
      <a class="current" href="./">
        Opis doniczki
          <span class="toctree-expand"></span>
      </a>
    </li>
    
      



  <li class="toctree-l2 current">
    <ul class="subnav-l2 current">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#opis-caego-schematu">Opis całego schematu</a>
        </li>
    
    </ul>
  </li>

      

  <li class="toctree-l2">
    <a href="#opis-czujnikow">
      Opis czujników
      <span class="toctree-expand"></span>
    </a>
  </li>



  <li class="toctree-l2">
    <ul class="subnav-l2 toc-hidden">
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#czujnik-temperatury-i-wilgotnosci-dht11">Czujnik temperatury i wilgotności DHT11</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#czujnik-natezenia-swiata">Czujnik natężenia światła</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#czujnik-wilgotnosci-gleby">Czujnik wilgotności gleby</a>
        </li>
    
      
        <li class="toctree-l3">
          <a class="toctree-l4" href="#pompa-do-wody">Pompa do wody</a>
        </li>
    
    </ul>
  </li>


  
        
      </ul>
    </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Azure</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../ioT_hub/">IoT Hub</a>
  </li>
        
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../analizaDanych/">Analiza danych</a>
  </li>
        
      </ul>
    </li>
    
      


  <li class="navtree toctree-l1 inactive">
    <a class="" href="../komunikacja/">Komunikacja</a>
  </li>
    
      
  <li class="navtree toctree-l1 label">
    <p class="caption">Dokumentacja</p>
  </li>


  

  
    <li class="navtree toctree-l1 group">
      <ul class="navtree subnav-l1 current">
          


  <li class="navtree toctree-l2 inactive">
    <a class="" href="../dokumentacja/">Edycja dokumentacji</a>
  </li>
        
      </ul>
    </li>
    
  </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">IoTAzurePi</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>Urządzenie IoT &raquo;</li>
        
      
    
    <li>Opis doniczki</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="opis-doniczki">Opis doniczki</h1>
<h2 id="opis-caego-schematu"><a href="#opis-calego-schematu">Opis całego schematu</a></h2>
<p>Gotowy schemat połączeniowy doniczki zaprezentowano poniżej:</p>
<p><img src="../media/schemat_urzadzenia_iot.png" alt="drawing" width="600" height="600"/></p>
<p>Składa się on z:</p>
<ul>
<li>lampki LED</li>
<li>czujnika wilgotności gleby</li>
<li>przetwornika analogowo-cyfrowego</li>
<li>czujnika natężenia światła</li>
<li>czujnika temperatury i wilgotności</li>
<li>pompki do wody</li>
<li>mostka H</li>
</ul>
<p>Do pomiaru temperatury i wilgotności użyto czujnik wilgotności DHT11. Został on umieszczony na zewnętrznej części doniczki, aby zbierać pomiar temperatury i wilgotności pomieszczenia. Urządzenie komunikuje się z Raspberry Pi za pomocą interfejsu jednoprzewodowego podłączonego do GPIO 17. DHT11 umieszczony na doniczce:</p>
<p><img src="../media/doniczka_DHT11.jpeg" alt="drawing" width="600" height="600"/></p>
<p>W celu zmierzenia naświetlenia rośliny wykorzystano czujnik natężenia światła BH1750. Zamieszczono go na brzegu doniczki, nad powierzchnią gleby, aby znajdował się na podobnym poziomie co roślina i jego wyniki jak najdokładniej oddawały warunki uprawianej rośliny. Czujnik jest cyfrowy i komunikuje się z jednostką centralną za pomocą magistrali I2C.</p>
<p><img src="../media/doniczka_BH1750.jpeg" alt="drawing" width="600" height="600"/></p>
<p>Pomiar wilgotności gleby odbywa się za pomocą sondy pomiarowej umieszczonej w glebie, która została podłączona do detektora. Pod wpływem wilgotności zmienia się rezystancja sondy i detektor generuje sygnał proporcjonalny do wilgotności. Sygnał ten jest sygnałem analogowym. Raspberry Pi nie ma wbudowanego przetwornika analogowo-cyfrowego, więc zastosowano zewnętrzny moduł ADS1115. Jest to moduł z przetwornikiem analogowo-cyfrowym o rozdzielczości 16 bitów i komunikujący się za pomocą magistrali I2C. Detektor podłączono do modułu, a moduł został podłączony do Raspberry Pi. Konwersja sygnału otrzymanego z detektora jest realizowana w jednostce centralnej</p>
<p><img src="../media/doniczka_sonda_wilgotnosci.jpeg" alt="drawing" width="600" height="600"/></p>
<p>Lampka i silnik są sterowane za pomocą dwukanałowego mostka H - L293D. Mostek ten jest zasilany napięciem 5V i za pomocą sygnałów PWM generowanych przez Raspberry Pi możliwe sterowanie natężeniem światła lub pompką. Mostek ma wbudowane diody zabezpieczające, dzięki którym możemy zabezpieczyć Raspberry Pi przed zwarciem. Do silnika została podłączona gumowa rurka, a silnik został umieszczony w zbiorniku z wodą. Lampka została umieszczona w glebie, a przewody zasilające zostały zabezpieczone przed wilgocią.</p>
<p><img src="../media/doniczka_lampka.jpeg" alt="drawing" width="600" height="600"/></p>
<p><img src="../media/doniczka_rurka.jpeg" alt="drawing" width="600" height="600"/></p>
<p>Gotowa doniczka prezentuje się następująco:</p>
<p><img src="../media/doniczka_calosc.jpeg" alt="drawing" width="600" height="600"/></p>
<h1 id="opis-czujnikow">Opis czujników</h1>
<p>Do zrealizowania części sprzętowej skorzystano z modułów komunikacyjnych wbudowanych w platformę mikroprocesorową Raspberry Pi. Rozpisane piny urządzenia znajdują się na rysunku poniżej:</p>
<hr />
<h2 id="czujnik-temperatury-i-wilgotnosci-dht11"><a href="#czujnik-temperatury-i-wilgotności-dht11">Czujnik temperatury i wilgotności DHT11</a></h2>
<p>Do pomiaru temperatury i wilgotności użyto czujnik wilgotności DHT11. Jest to czujnik cyfrowy z interfejsem jednoprzewodowym. Zakres jego pracy dla temperatury to od -20 °C do +60 °C, a wilgotności od 5 % do 95 % RH. Czujnik ma rozdzielczość 8-bitową, przez co jego dokładność to 1°C oraz ±1 % RH.</p>
<p><img src="../media/dht11.png" alt="drawing" width="400" height="400"/></p>
<p>Czujnik podłączony został do napięcia 3.3 V urządzenia Raspberry Pi (pin 1), uziemienie do pinu 9 oraz dane zostały podłączone do GPIO 17 dostępnego na pinie 11.
W celu poprawnej komunikacji jednoprzewodowej konieczne jest zastosowanie rezystora pomiędzy napięciem a linią danych. Rezystor powinien mieć wartość o 4.7k do 10k Ohm. Połączenie czujnika z RPi zostało przedstawione na poniższym rysunku:</p>
<p><img src="../media/DHT11_pi.png" alt="drawing" width="400" height="400"/></p>
<p>Do połączenia się z czujnikiem wykorzystano gotową bibliotekę od Adafruit. W celu instalacji tej biblioteki trzeba wykonać następujące kroki:
Zainstalować potrzebne narzędzia:</p>
<pre><code>    sudo apt-get update
    sudo apt-get install build-essential python-dev
</code></pre>
<p>Następnie pobrać bibliotekę z repozytorium na githubie:
git clone https://github.com/adafruit/Adafruit_Python_DHT.git
cd Adafruit_Python_DHT
Następnie zainstalować bibliotekę dla Pythona 2 i Pythona 3 za pomocą komend:</p>
<pre><code>    sudo python setup.py install
    sudo python3 setup.py install
</code></pre>
<p>Do komunikacji z czujnikiem został napisany skrypt w języku Python. Przykładowy kod programu umożliwiający komunikację z czujnikiem:</p>
<pre><code>    import sys

    import Adafruit_DHT

    # 11 stand for DHT-11 and 17 stands for GPIO pin
    humidity, temperature = Adafruit_DHT.read_retry(11, 17)

    if humidity is not None and temperature is not None:
    print('Temp={0:0.1f}*  Humidity={1:0.1f}%'.format(temperature, humidity))
    else:
    print('Failed to get reading. Try again!')
    sys.exit(1)
</code></pre>
<hr />
<h2 id="czujnik-natezenia-swiata"><a href="#czujnik-natężenia-światła">Czujnik natężenia światła</a></h2>
<p>Zastosowanym czujnikiem światła jest BH1750. Jest to czujnik przetwarzający natężenie światła o długości z zakresu od 320 nm do 1050 nm na mierzalną (np. poprzez zastosowanie mikrokontrolera) proporcjonalną częstotliwość. Zakres działania czujnika to 1-65535 lx (luksów) z rozdzielczością 1 lub 4 lx w zależności od wybranego trybu pracy. Komunikuje się poprzez interfejs I2C (TWI), czyli dwie linie: danych - SDA i zegarową SCL.</p>
<p><img src="../media/Czujnik_natenia_wiata_GY-30_-_BH1750_1.jpg" alt="drawing" width="400" height="400"/></p>
<p>Czujnik podłączony został do napięcia 3.3 V z urządzenia Raspberry Pi, uziemienie do GND oraz dane zostały podłączone do GPIO 2 (SDA) oraz do GPIO 3 (SCL) został podłączony zegar interfejsu I2C.</p>
<p><img src="../media/BH1750-Module-Setup.png" alt="drawing" width="400" height="400"/></p>
<p>Do komunikacji z czujnikiem wykorzystano magistralę I2C. Po podłączeniu pinu ADD do uziemienie urządzenie ma adres 0x23. Można ustawić różne tryby odczytu. Wykorzystany został tryb 0x20, jest to tryb umożliwiający odczyt z dokładnością do 1 lx oraz pozwalający na wyłączenie urządzenia po odczycie w celu oszczędzenia energii. Przykładowy kod w języku Python:</p>
<pre><code>    def convert_GY30_to_Number(data):
    # Simple function to convert 2 bytes of data
    # into a decimal number.
    result=(data[1] + (256 * data[0])) / 1.2
    return (result)

    def read_data_GY30():
    bus = smbus.SMBus(1)  # Rev 2 Pi uses 1
    # 0x23 is an addres of device, 0x20 is measurement at 1lx resolution.
    # Time typically 120ms
    # Device is automatically set to Power Down after measurement.
    data = bus.read_i2c_block_data(0x23,0x20)
    return convert_GY30_to_Number(data)
</code></pre>
<hr />
<h2 id="czujnik-wilgotnosci-gleby"><a href="#czujnik-wilgotności-gleby">Czujnik wilgotności gleby</a></h2>
<p>Zasilany jest napięciem od 3,3 V do 5 V.  Urządzenie składa się z trzech części: sondy pomiarowej, modułu detektora oraz przewodów. Sondy należy połączyć z modułem głównym przy pomocy przewodów i umieścić w glebie, której wilgotność będzie mierzona.</p>
<p>Czujnik posiada wyjście cyfrowe D0 sygnalizujące przekroczenie ustawionej za pomocą potencjometru wartości oraz analogowe A0 przy pomocy którego uzyskuje się dokładną wartość wilgotności. Za pomocą potencjometru ustawiany jest próg, po którego przekroczeniu wyjście D0 przechodzi ze stanu wysokiego w stan niski. Czujnik posiada także wyjście analogowe A0, które należy podłączyć do wyprowadzenia przetwornika A/C, a następnie możliwe jest za pomocą interfejsu I2C połączenie z urządzeniem Raspberry Pi. </p>
<p><img src="../media/gleba.png" alt="drawing" width="400" height="400"/></p>
<hr />
<h2 id="pompa-do-wody"><a href="#pompa-do-wody">Pompa do wody</a></h2>
<p>Do podlewania rośliny w doniczce została wykorzystana pompka do wody działająca na bazie komutatorowego silnika prądu stałego. Pompa zasilana jest napięciem od 2.5 - 6 V. Prąd pobierany przez silnik wynosi 130-220 mA. Wydajność przepływu cieczy to 80-120 L/h. 
Maksymalny prąd, który może być pobierany z zasilania 5V urządzenia Raspberry Pi to 300 mA, więc z urządzenia bez problemu można zasilić pompę do wody. Do wysterowania silnikiem został użyty mostek H L293D. </p>
<p><img src="../media/pompka.png" alt="drawing" width="400" height="400"/></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../ioT_hub/" class="btn btn-neutral float-right" title="IoT Hub">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../cosmoDB/" class="btn btn-neutral" title="CosmoDB"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../cosmoDB/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../ioT_hub/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
